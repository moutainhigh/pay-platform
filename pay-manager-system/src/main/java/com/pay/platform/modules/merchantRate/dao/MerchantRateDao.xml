<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.pay.platform.modules.merchantRate.dao.MerchantRateDao">


    <resultMap id="BaseResultMap" type="com.pay.platform.modules.merchantRate.model.MerchantRateModel">
        <id column="ID" jdbcType="VARCHAR" property="id"/>
        <result column="MERCHANT_ID" jdbcType="VARCHAR" property="merchantId"/>
        <result column="CHANNEL_ID" jdbcType="VARCHAR" property="channelId"/>
        <result column="RATE" jdbcType="NUMERIC" property="rate"/>
        <result column="CREATE_TIME" jdbcType="VARCHAR" property="createTime"/>
    </resultMap>

    <resultMap id="ListMap" type="com.pay.platform.modules.merchantRate.model.MerchantRateListModel">
        <result column="CHANNEL_NAME" jdbcType="VARCHAR" property="channelName"/>
        <result column="RATE" jdbcType="NUMERIC" property="rate"/>
        <result column="ID" jdbcType="VARCHAR" property="id"/>
    </resultMap>


    <insert id="add" parameterType="MerchantRateModel">
        replace into tb_merchant_rate
         (id , merchant_id , channel_id , rate , create_time)
        values
        (uuid() , #{merchantId} , #{channelId} , #{rate} , now());
    </insert>

    <!--查询商家的渠道费率-->
    <select id="queryMerchantRateList" resultMap="ListMap">
        select
          t1.rate RATE,t2.channel_name CHANNEL_NAME,t1.ID
        from
          tb_merchant_rate t1 left join tb_pay_channel t2 on t1.channel_id = t2.id
        where
          merchant_id=#{merchantId}
    </select>


    <!--查询商家的渠道费率-->
    <delete id="delete" >
        delete from tb_merchant_rate where id=#{id}
    </delete>


</mapper>